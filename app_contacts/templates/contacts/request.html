{% extends "contacts/connects_base.html" %}
{% load static %}
{% block connect_content %}

<link rel="stylesheet" href="{% static 'app_contacts/css/request.css' %}">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<h3 class="fw-bold mb-4 d-flex justify-content-between align-items-center">
    
    <span>
        ðŸ”” Connection Requests 
        <span class="badge bg-primary" id="reqCount">{{ requests|length }}</span>
    </span>

    <!-- ðŸ” Advanced Search -->
    <input id="searchReq" type="text" class="form-control"
        placeholder="Search name / email / phone..."
        style="max-width:250px;border-radius:8px;">
</h3>

{% if not requests %}
<div class="alert alert-info text-center">No pending requests.</div>
{% endif %}

<div class="req-list" id="reqContainer">

{% for r in requests %}
<div class="req-card req-item"
     id="req-{{ r.id }}"
     data-name="{{ r.visitor.full_name|default:r.visitor.username|lower }}"
     data-email="{{ r.visitor.email|lower }}"
     data-phone="{{ r.visitor.phone|default:'' }}"
     data-username="{{ r.visitor.username|lower }}"
>

    <div class="flex">
        <img src="{% if r.visitor.profile_picture %}{{ r.visitor.profile_picture.url }}{% else %}https://via.placeholder.com/60{% endif %}" 
             class="req-avatar">

        <div>
            <h5>{{ r.visitor.full_name|default:r.visitor.username }}</h5>
            <small>{{ r.visitor.email }}</small><br>
            {% if r.visitor.phone %}<small>ðŸ“ž {{ r.visitor.phone }}</small>{% endif %}
        </div>
    </div>

    <div class="btn-area">
        <!-- Prevent default submit -->
        <button type="button" class="btn-accept" data-id="{{ r.id }}">Accept</button>
        <button type="button" class="btn-reject" data-id="{{ r.id }}">Reject</button>
    </div>

</div>
{% endfor %}

</div>

<script src="{% static 'app_contacts/js/request.js' %}"></script>

{% endblock %}
